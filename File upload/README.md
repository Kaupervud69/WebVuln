### **FILE UPLOAD**
* **Описание**
Unrestricted File Upload — небезопасная загрузка файлов. С помощью этой уязвимости злоумышленник обходит механизмы безопасности, загружает и выполняет вредоносный файл на сервере.
* **Причины**
Уязвимость возникает из-за неправильной проверки и фильтрации загружаемых файлов на стороне сервера. Например, если сервер не определяет тип, расширение, размер и наличие исполняемого кода в файле.
В некоторых случаях сам факт загрузки файла может быть достаточным для нанесения ущерба. Другие атаки могут включать последующий HTTP-запрос на файл, как правило, для запуска его выполнения сервером.
* **Виды**
* **Точки входа**
* **POC**
* **Профит**
Влияние уязвимостей загрузки файлов обычно зависит от двух ключевых факторов:
Какой аспект файла веб-сайт не может проверить должным образом, будь то его размер, тип, содержимое и т. д.
Какие ограничения налагаются на файл после его успешной загрузки.
* **Защита**

* **Обход защиты**
* 	Некорректная проверка типа файла
При отправке HTML-форм браузер обычно отправляет предоставленные данные в запросе POST с типом содержимого application/x-www-form-url-encoded. Этого достаточно для отправки простого текста, например вашего имени или адреса. Однако это не подходит для отправки больших объемов двоичных данных, таких как целый файл изображения или документ PDF. В этом случае предпочтительнее тип содержимого multipart/form-data.
* 	Предотвращение выполнения файлов в каталогах, доступных пользователю
В качестве меры предосторожности серверы обычно запускают только те скрипты, MIME-тип которых был явно настроен на выполнение. Такая конфигурация часто различается между каталогами. Каталог, в который загружаются предоставленные пользователем файлы, скорее всего, будет иметь гораздо более строгий контроль, чем другие расположения в файловой системе, которые, как предполагается, недоступны для конечных пользователей.
Веб-серверы часто используют поле имени файла в запросах multipart/form-data для определения имени и места сохранения файла.
*	Недостаточное внесение в черный список опасных типов файлов 
черные списки иногда можно обойти, используя менее известные альтернативные расширения файлов, которые все еще могут быть исполняемыми, например, .php5, .shtml и т. д.php можно заменить на: .php, .php2, .php3, . php4, . php5, . php6, . php7, .phps, . pht, . phtm, .phtml, . pgif, .shtml, .htaccess, .phar, .inc, .hphp, .ctp, .module
*	Переопределение конфигурации сервера
Многие серверы также позволяют разработчикам создавать специальные файлы конфигурации в отдельных каталогах, чтобы переопределить или добавить один или несколько глобальных параметров. Например, серверы Apache будут загружать конфигурацию, специфичную для каталога, из файла .htaccess, если он присутствует.
Замените содержимое файла (полезную нагрузку PHP) следующей директивой Apache:
AddType application/x-httpd-php .l33t
Это сопоставляет произвольное расширение (.l33t) с исполняемым типом MIME application/x-httpd-php. Поскольку сервер использует модуль mod_php, он уже знает, как это обрабатывать.
*	Обфускация расширений файлов
1.   Укажите несколько расширений.
my_file.png.php
my_file.jpeg.html
2.    Добавить спецсимволы после расширения. Этот обход основан на особенностях низкоуровневых парсеров. Приведённые нагрузки интерпретируются как разрыв строки или null byte — окончание строки.
my_file*.php%20*
my_file*.php%0a*
my_file*.php%00*
my_file*.php%0d%0a*
my_file*.php/*
my_file*.php.\*
3.    Отрезать разрешённое расширение.
my_file.php#.png
my_file.php%00.png
my_file.php\x00.png
my_file.php%0a.png
my_file.php%0d%0a.png
4.   Добавьте конечные символы. Некоторые компоненты будут удалять или игнорировать конечные пробелы, точки и тому подобное: 
Exploit.php.
5.   Попробуйте использовать кодировку URL (или двойную кодировку URL) для точек, прямых и обратных слешей.
Exploit%2Ephp
6.    Добавьте точки с запятой или URL-кодированные нулевые байтовые символы перед расширением файла. Если проверка написана на языке высокого уровня, таком как PHP или Java, но сервер обрабатывает файл с помощью функций более низкого уровня в C/C++
Exploit.asp;.jpg 
Exploit.asp%00.jpg
7.   использовать многобайтовые символы Unicode, которые могут быть преобразованы в нулевые байты и точки после преобразования Unicode или нормализации
xC0 x2E, xC4 xAE или xC0 xAE, могут быть преобразованы в x2E, если имя файла проанализировано как строка UTF-8, но затем преобразовано в символы ASCII перед использованием в пути.
8.   Другие способы защиты включают удаление или замену опасных расширений, чтобы предотвратить выполнение файла.
exploit.p.phphp
9.   Выявить лимит на длину имени
veerrryyy_loonnggg_naaamme.php.png

