### **LOGIC**

* **Описание**
	Уязвимости бизнес-логики — это недостатки в разработке и реализации приложения, которые позволяют злоумышленнику вызывать непреднамеренное поведение. Это потенциально позволяет злоумышленникам манипулировать законной функциональностью для достижения вредоносной цели. Эти недостатки, как правило, являются результатом неспособности предвидеть необычные состояния приложения, которые могут возникнуть, и, следовательно, неспособности безопасно их обрабатывать.
	
* **Виды**
*	Чрезмерное доверие к клиентским элементам управления
Принципиально ошибочное предположение заключается в том, что пользователи будут взаимодействовать с приложением только через предоставленный веб-интерфейс.
Нарушенная логика 2FA
*	Неспособность обрабатывать нестандартные входные данные
Ввести данные в диапазонах, которые легитимные пользователи вряд ли когда-либо введут.(высокие или исключительно числовые входные данные и необычно длинные строки для текстовых полей, неожиданные типы данных.) 
Наблюдая за реакцией приложения, следует попытаться ответить на следующие вопросы:
Существуют ли какие-либо ограничения, налагаемые на данные?
Что происходит, когда вы достигаете этих ограничений?
Выполняется ли какое-либо преобразование или нормализация ваших входных данных?
1. Уязвимость логики высокого уровня - В этот раз у тебя нет параметра цены price, с которым можно проводить манипуляции, но есть параметр количества quantity. Поменяй его значение на -1.
2. Недостаток логики низкого уровня - Цена превысила максимально допустимое значение для целого числа в языке программирования бэкэнда (2 147 483 647). В результате значение вернулось к минимально возможному значению (-2 147 483 648)
3. Непоследовательная обработка исключительных входных данных - Убедитесь, что very-long-string содержит правильное количество символов, чтобы «m» в конце @dontwannacry.com было ровно 255 символов.
*	Ошибочные предположения о поведении пользователей
Удаляйте только один параметр за раз, чтобы гарантировать достижение всех соответствующих путей кода.
Попробуйте удалить имя параметра, а также значение. Сервер обычно обрабатывает оба случая по-разному.
Выполняйте многоэтапные процессы до завершения. Иногда изменение параметра на одном этапе может повлиять на другой шаг далее в рабочем процессе.
Это относится как к параметрам URL, так и к параметрам POST, но не забудьте также проверить файлы cookie. Этот простой процесс может выявить странное поведение приложения, которое может быть использовано злоумышленниками.
1. Непоследовательные элементы управления безопасностью - Убедитесь, что very-long-string содержит правильное количество символов, чтобы «m» в конце @dontwannacry.com было ровно 255 символов.
2. Пользователи не всегда вводят обязательные данные - При проверке логических ошибок следует попробовать удалить каждый параметр по очереди и посмотреть, как это повлияет на ответ.
3. Пользователи не всегда будут следовать предполагаемой последовательности - Чтобы выявить такие недостатки, следует использовать принудительный просмотр для отправки запросов в непреднамеренной последовательности. Например, вы можете пропустить определенные шаги, получить доступ к одному шагу более одного раза, вернуться к более ранним шагам и т. д. Обратите внимание на то, как осуществляется доступ к разным шагам.
*	Недостатки, специфичные для домена
*	Предоставление оракула шифрования
контролируемые пользователем входные данные шифруются, а полученный зашифрованный текст затем каким-то образом предоставляется пользователю.
*	Несоответствия парсера адресов электронной почты
=?utf-8?q?=61=62=63?=foo@ginandjuice.shop

* **Профит**
	По сути, влияние любого логического недостатка зависит от того, с какой функциональностью он связан. Например, если недостаток находится в механизме аутентификации, это может серьезно повлиять на вашу общую безопасность. Злоумышленники могут потенциально использовать это для повышения привилегий или полностью обойти аутентификацию, получив доступ к конфиденциальным данным и функциям. Это также открывает увеличенную поверхность атаки для других эксплойтов.
Ошибочная логика в финансовых транзакциях, очевидно, может привести к огромным потерям для бизнеса из-за кражи средств, мошенничества и т. д.

* **Защита**
* Убедитесь, что разработчики и тестировщики понимают домен, который обслуживает приложение
* Избегайте делать неявные предположения о поведении пользователя или поведении других частей приложения
* Вы должны определить, какие предположения вы сделали о состоянии на стороне сервера, и реализовать необходимую логику для проверки того, что эти предположения выполняются. Это включает в себя проверку того, что значение любого ввода разумно, прежде чем продолжить.

