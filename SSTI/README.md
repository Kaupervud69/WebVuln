### **SSTI(server)**

* **Описание**
	Внедрение шаблона на стороне сервера происходит, когда злоумышленник может использовать собственный синтаксис шаблона для внедрения вредоносной нагрузки в шаблон, который затем выполняется на стороне сервера.
	
* **Точки входа**
	Во время аудита мы можем проверить внедрение шаблона на стороне сервера, запросив URL, например http://vulnerable-website.com/?username=${7*7}
	
	Контекст открытого текста - в форме имени переменной, контролируемой пользователем, помещенного в параметр.Во время аудита мы можем проверить внедрение шаблона на стороне сервера, запросив URL, например http://vulnerable-website.com/?username=${7*7}
	Контекст кода - На веб-сайте результирующий URL будет выглядеть примерно так http://vulnerable-website.com/?greeting=data.username
	
* **POC**
	${{<%[%'"}}%\
	
	}}{%25+import+os+%25}{{os.system('rm%20/home/carlos/morale.txt')
	<%=system+("rm+/home/carlos/morale.txt")%>
	
* **Профит**
SSTI позволяет злоумышленнику не только выполнять команды на сервере, но и получить полный доступ к серверной инфраструктуре. Это может включать:

	Доступ к конфиденциальной информации и данным пользователей.
   	Возможность установки бэкдоров или вредоносного ПО на сервере.
   	Потенциальное использование сервера для атак на другие системы.

* **Защита**
	Один из самых простых способов избежать внедрения уязвимостей внедрения шаблонов на стороне сервера — всегда использовать шаблонизатор «без логики», такой как Mustache, если только это не является абсолютно необходимым. Максимальное разделение логики и представления может значительно снизить вашу подверженность самым опасным атакам на основе шаблонов.

	Другая мера — выполнять код пользователя только в изолированной среде, где полностью удалены потенциально опасные модули и функции. К сожалению, изолирование ненадежного кода изначально сложно и подвержено обходам.

	Наконец, еще один дополнительный подход — признать, что выполнение произвольного кода практически неизбежно, и применить собственную изолированную среду, развернув среду шаблонов в заблокированном контейнере Docker, например.

	Никогда не передавай пользовательский ввод напрямую в шаблон! Это главное правило предотвращения SSTI. Обязательно нужно валидировать данные перед использованием
	Использование шаблонизаторов, не поддерживающих логику (Mustache)
	Другая мера — выполнять код пользователя только в изолированной среде, где полностью удалены потенциально опасные модули и функции. К сожалению, изолирование ненадежного кода изначально сложно и подвержено обходам.
	
